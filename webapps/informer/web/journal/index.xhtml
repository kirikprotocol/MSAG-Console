<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:tr="http://myfaces.apache.org/trinidad"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:eye="http://taglib.eyeline.mobi">

<ui:composition template="/templates/main.xhtml">

  <ui:param name="pageTitle" value="#{msg['journal.page.title']}"/>

  <ui:define name="content">
    <h:form>

      <h:inputHidden value="#{journal.init}"/>

      <eye:dataTableFilter bean="#{journal}" clearAction="clearFilter" applyAction="query">
        <h:panelGrid columns="4" columnClasses="column50WidthNoWrap, column400Width, column50WidthNoWrap, columnTopLeftAlign">


          <h:outputText value="#{msg['journal.page.user']}"/>
          <h:selectOneMenu value="#{journal.filterByUser}">
            <f:selectItems value="#{journal.uniqueUsers}"/>
          </h:selectOneMenu>

          <h:outputText value="#{msg['journal.page.subject']}"/>
          <h:selectOneMenu value="#{journal.filterBySubject}" >
            <f:selectItems value="#{journal.uniqueSubjectNamesFromJournal}"/>
          </h:selectOneMenu>

          <h:outputText value="#{msg['journal.page.from_date']}"/>
          <eye:inputDate value="#{journal.filterByStartDate}" type="both" autocomplete="true"/>

          <h:outputText value="#{msg['journal.page.till_date']}"/>
          <eye:inputDate value="#{journal.filterByEndDate}" type="both" autocomplete="true"/>
        </h:panelGrid>
      </eye:dataTableFilter>

      <eye:delimiter/>

      <eye:dataTable value="#{journal.records}" var="rec" rendered="#{journal.init}">
        <eye:row>
          <eye:column name="time" title="#{msg['journal.page.time']}" sortable="true" width="15%" align="center" defaultSortOrder="desc">
            <h:outputText value="#{rec.date}">
              <f:convertDateTime dateStyle="short" type="both"/>
            </h:outputText>
          </eye:column>
          <eye:column name="user" title="#{msg['journal.page.user']}" sortable="true" width="7%" align="center">
            <h:outputText value="#{rec.user}" title="#{rec.userDetails}"/>
          </eye:column>
          <eye:column name="subject" title="#{msg['journal.page.subject']}" sortable="true" width="8%" align="center">
            <h:outputText value="#{rec.subject}"/>
          </eye:column>
          <eye:column name="description" title="#{msg['journal.page.description']}" width="70%">
            <h:outputText value="#{rec.description}"/>
          </eye:column>
        </eye:row>
      </eye:dataTable>

      <h:panelGroup style="#{journal.init ? '' : 'display:none'}">
        <eye:delimiter/>
        <eye:buttons>
          <eye:space/>
          <eye:button>
            <h:commandLink value="#{msg['download.button']}">
              <tr:fileDownloadActionListener method="#{journal.download}" contentType="application/csv" filename="journal.csv"/>
            </h:commandLink>
          </eye:button>
        </eye:buttons>
      </h:panelGroup>
    </h:form>
  </ui:define>

</ui:composition>


</html>