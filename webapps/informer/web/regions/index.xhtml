<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:tr="http://myfaces.apache.org/trinidad"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:eye="http://taglib.eyeline.mobi"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">

<ui:composition template="/templates/main.xhtml">

  <ui:param name="pageTitle" value="#{msg['informer.admin.regions']}"/>

  <ui:define name="content">

    <tr:form id="smsc">

      <eye:pageSubtitle value="#{msg['region.default.max']}"/>

      <tr:subform>
        <h:panelGrid columns="3" columnClasses="column100Width, column100Width,columnTopLeftAlign">
          <h:inputText converterMessage="#{msg['invalid_param_value']} #{msg['region.default.max']}" size="8" value="#{regions.defaultMax}"/>
          <tr:commandLink text="#{msg['apply.button']}" shortDesc="#{msg['region.apply.default.max.desc']}" action="#{regions.submitDefault}"/>
          <h:outputText/>
        </h:panelGrid>
      </tr:subform>

      <eye:delimiter/>

      <eye:pageSubtitle value="#{msg['region.regions']}"/>

      <eye:dataTableFilter bean="#{regions}" clearAction="clearFilter">
        <h:panelGrid columns="4" columnClasses="column50Width, column400Width, column50Width, columnTopLeftAlign">
          <h:outputText value="#{regionBundle.name}"/>
          <tr:inputText value="#{regions.regionPrefix}" simple="true" columns="50"/>

          <h:outputText value="#{regionBundle.smsc}"/>
          <h:selectOneMenu value="#{regions.smscPrefix}">
            <f:selectItem itemLabel="" itemValue=""/>
            <f:selectItems value="#{regions.smscs}"/>
          </h:selectOneMenu>

          <h:outputText value="#{regionBundle.mask}"/>
          <h:inputText value="#{regions.address}" converter="addressConverter" converterMessage="#{msg['invalid_param_value']} #{regionBundle.mask}"/>

          <h:outputText value="&#160;"/>
          <h:outputText value="&#160;"/>
        </h:panelGrid>
      </eye:dataTableFilter>

      <eye:delimiter/>

      <eye:buttons>
        <eye:button>
          <tr:commandLink text="#{msg['add.button']}" shortDesc="#{msg['region.add.desc']}" action="REGION_EDIT"/>
        </eye:button>

        <eye:button>
          <eye:menubar label="#{msg['region.selected']}...">
            <eye:menubaritem><tr:commandLink text="#{msg['edit.selected.button']}" shortDesc="#{msg['edit.selected.button']}" action="#{regions.editGroup}"/></eye:menubaritem>
            <eye:menubaritem><tr:commandLink text="#{msg['delete.button']}" shortDesc="#{msg['region.delete.desc']}" action="#{regions.remove}" onclick="if (!confirm('#{msg['informer.delete.records']}')) return false"/></eye:menubaritem>
          </eye:menubar>
        </eye:button>

        <eye:space/>
        <eye:button>
          <tr:commandLink text="#{msg['download.button']}" shortDesc="#{msg['region.download.desc']}">
            <tr:fileDownloadActionListener method="#{regions.download}" contentType="application/csv" filename="regions.csv"/>
          </tr:commandLink>
        </eye:button>
        <eye:button>
          <tr:commandLink text="#{msg['upload.button']}" shortDesc="#{msg['region.upload.desc']}" action="REGION_UPLOAD"/>
        </eye:button>
      </eye:buttons>

      <eye:delimiter/>

      <eye:dataTable value="#{regions.regionsModel}" selectedRows="#{regions.selected}" var="m">
        <eye:row rowId="#{m.regionId}" innerData="#{!(empty m.masks)}">

          <eye:column name="name" title="#{regionBundle.name}" sortable="true" width="25%" align="center">
            <h:commandLink value="#{m.name}" action="REGION_EDIT" title="#{msg['region.details']}">
              <f:param name="REGION_ID" value="#{m.regionId}"/>
            </h:commandLink>
          </eye:column>

          <eye:column name="smsc" title="#{regionBundle.smsc}" sortable="true" width="25%" align="center">
            <h:outputText value="#{m.smsc}"/>
          </eye:column>

          <eye:column name="timezone" title="#{regionBundle.timeZone}" sortable="true" width="25%" align="center">
            <h:outputText value="#{m.timeZone}" converter="timeZoneConverter"/>
          </eye:column>

          <eye:column name="maxPerSecond" title="#{regionBundle.maxSmsPerSecond}" sortable="true" width="25%" align="center">
            <h:outputText value="#{m.maxSmsPerSecond}"/>
          </eye:column>

          <f:facet name="innerData">
            <h:panelGroup>
            <h:dataTable value="#{m.masks}" var="mask" >
              <h:column>

                  <h:outputText value="#{mask}" converter="addressConverter"/>

              </h:column>
            </h:dataTable>
            </h:panelGroup>
          </f:facet>

        </eye:row>
      </eye:dataTable>

      <eye:delimiter/>

      <eye:buttons>
        <eye:button>
          <tr:commandLink text="#{msg['add.button']}" shortDesc="#{msg['region.add.desc']}" action="REGION_EDIT"/>
        </eye:button>

        <eye:button>
          <eye:menubar label="#{msg['region.selected']}...">
            <eye:menubaritem><tr:commandLink text="#{msg['edit.selected.button']}" shortDesc="#{msg['edit.selected.button']}" action="#{regions.editGroup}"/></eye:menubaritem>
            <eye:menubaritem><tr:commandLink text="#{msg['delete.button']}" shortDesc="#{msg['region.delete.desc']}" action="#{regions.remove}" onclick="if (!confirm('#{msg['informer.delete.records']}')) return false"/></eye:menubaritem>
          </eye:menubar>
        </eye:button>

        <eye:space/>
        <eye:button>
          <tr:commandLink text="#{msg['download.button']}" shortDesc="#{msg['region.download.desc']}">
            <tr:fileDownloadActionListener method="#{regions.download}" contentType="application/csv" filename="regions.csv"/>
          </tr:commandLink>
        </eye:button>
        <eye:button>
          <tr:commandLink text="#{msg['upload.button']}" shortDesc="#{msg['region.upload.desc']}" action="REGION_UPLOAD"/>
        </eye:button>
      </eye:buttons>

    </tr:form>

  </ui:define>

</ui:composition>


</html>


