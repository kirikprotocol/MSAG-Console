<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:tr="http://myfaces.apache.org/trinidad"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:eye="http://taglib.eyeline.mobi">

<ui:composition template="/templates/main.xhtml">

  <ui:param name="pageTitle" value="#{msg['user.groupEdit.title']}"/>

  <ui:define name="content">

    <tr:form>

      <eye:buttons>
        <eye:button>
          <tr:commandLink text="#{msg['done.button']}" action="#{userGroupEdit.save}"/>
        </eye:button>
        <eye:button>
          <tr:commandLink text="#{msg['cancel.button']}" action="USERS" immediate="true"/>
        </eye:button>
        <eye:space/>
      </eye:buttons>


      <h:panelGrid style="padding:10px" columns="3" columnClasses="column20Width, column100Width, columnTopLeftAlign">

        <h:selectBooleanCheckbox id="editOrganization" value="#{userGroupEdit.editOrganization}" onchange="document.getElementById('organization').disabled=!this.checked"/>
        <h:outputText style="white-space:nowrap;" value="#{userBundle.organization}"/>
        <tr:inputText id="organization" value="#{userGroupEdit.organization}" simple="true" />

        <h:selectBooleanCheckbox id="editAdmin" value="#{userGroupEdit.editAdmin}" onchange="document.getElementById('admin').disabled=!this.checked"/>
        <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.isAdmin']}"/>
        <h:selectBooleanCheckbox id="admin" value="#{userGroupEdit.admin}"/>

        <h:selectBooleanCheckbox id="editBlocked" value="#{userGroupEdit.editBlocked}" onchange="document.getElementById('blocked').disabled=!this.checked"/>
        <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.blocked']}"/>
        <h:selectBooleanCheckbox id="blocked" value="#{userGroupEdit.blocked}"/>

      </h:panelGrid>

      <p/>

      <eye:collapsingGroup label="#{msg['user.edit.defaults']}" opened="true">
        <h:panelGrid id="default" style="padding-left:10px; padding-top:10px" columns="3" columnClasses="column20Width,column100WidthNoWrap, columnTopLeftAlign">

          <h:selectBooleanCheckbox id="editSourceAddr" value="#{userGroupEdit.editSourceAddr}" onchange="document.getElementById('sourceAddr').disabled=!this.checked"/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.sourceAddr}"/>        
          <tr:inputText id="sourceAddr" value="#{userGroupEdit.sourceAddr}" simple="true" columns="15" />

          <h:selectBooleanCheckbox id="editDeliveryDays" value="#{userGroupEdit.editDeliveryDays}" onchange="
          for (var i = 0; i&lt;7; i++)
            document.getElementById('deliveryDays:' + i).disabled=!this.checked
          "/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.deliveryDays}"/>
          <h:selectManyCheckbox id="deliveryDays" value="#{userGroupEdit.deliveryDays}" style="width: 100px" >
            <f:selectItems value="#{userGroupEdit.daysItems}"/>
          </h:selectManyCheckbox>

          <h:selectBooleanCheckbox id="editDeliveryStartTime" value="#{userGroupEdit.editDeliveryStartTime}" onchange="
          document.getElementById('deliveryStartTime.hours').disabled=!this.checked;
          document.getElementById('deliveryStartTime.minutes').disabled=!this.checked"
              />
          <h:outputText style="white-space:nowrap;" value="#{userBundle.deliveryStartTime}"/>
          <eye:inputDate id="deliveryStartTime" value="#{userGroupEdit.deliveryStartTime}" type="short_time"/>

          <h:selectBooleanCheckbox id="editDeliveryEndTime" value="#{userGroupEdit.editDeliveryEndTime}" onchange="
          document.getElementById('deliveryEndTime.hours').disabled=!this.checked;
          document.getElementById('deliveryEndTime.minutes').disabled=!this.checked;
          "/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.deliveryEndTime}"/>
          <eye:inputDate id="deliveryEndTime" value="#{userGroupEdit.deliveryEndTime}" type="short_time"/>

          <h:selectBooleanCheckbox id="editPriority" value="#{userGroupEdit.editPriority}" onchange="document.getElementById('priority').disabled=!this.checked"/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.priority}"/>
          <tr:inputText id="priority" value="#{userGroupEdit.priority}" simple="true"  columns="3"/>

          <h:selectBooleanCheckbox id="editRetryPolicy" value="#{userGroupEdit.editRetryPolicy}" onchange="
          document.getElementById('retryPolicy').disabled=!this.checked || !document.getElementById('retryOnFail').checked;
          document.getElementById('retryOnFail').disabled=!this.checked;
          "/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.policyId}"/>
          <h:panelGroup>
            <h:selectBooleanCheckbox id="retryOnFail" value="#{userGroupEdit.retryOnFail}" style="position: relative; top: 2px; left: -3px;" onchange="document.getElementById('retryPolicy').disabled=!this.checked;"/>
            <h:inputText id="retryPolicy" value="#{userGroupEdit.policyId}" />
          </h:panelGroup>

          <h:selectBooleanCheckbox id="editSmsNotification" value="#{userGroupEdit.editSmsNotification}" onchange="document.getElementById('smsNotification').disabled=!this.checked"/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.smsNotification}"/>
          <tr:selectBooleanCheckbox id="smsNotification" value="#{userGroupEdit.smsNotification}" simple="true"/>

          <h:selectBooleanCheckbox id="editEmailNotification" value="#{userGroupEdit.editEmailNotification}" onchange="document.getElementById('emailNotification').disabled=!this.checked"/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.emailNotification}"/>
          <tr:selectBooleanCheckbox id="emailNotification" value="#{userGroupEdit.emailNotification}" simple="true" />

          <h:selectBooleanCheckbox id="editDeliveryType" value="#{userGroupEdit.editDeliveryType}" onchange="document.getElementById('deliveryType').disabled=!this.checked" style="display:#{userGroupEdit.allowUssdPushDeliveries ? '' : 'none'}"/>
          <h:outputText style="white-space:nowrap;display: #{userGroupEdit.allowUssdPushDeliveries ? '' : 'none'}" value="#{userBundle.deliveryType}" />
          <h:selectOneMenu id="deliveryType" value="#{userGroupEdit.deliveryType}" style="align:left;display: #{userGroupEdit.allowUssdPushDeliveries ? '' : 'none'}"  onchange="
          var dt = document.getElementById('deliveryType');
          var disp = dt.options[0].selected ? '' : 'none';
          document.getElementById('smsSettings').style.display=disp;
          ">
            <f:selectItems value="#{userGroupEdit.deliveryTypes}"/>
          </h:selectOneMenu>

        </h:panelGrid>

        <h:panelGrid id="smsSettings" style="padding-left:10px; display: #{userGroupEdit.smsDeliveryMode == true ? '' : 'none'}" columns="3" columnClasses="column20Width, column100Width, columnTopLeftAlign">

          <h:selectBooleanCheckbox id="editTransactionMode" value="#{userGroupEdit.editTransactionMode}" onchange="document.getElementById('transactionMode').disabled=!this.checked"/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.transactionMode}"/>
          <h:selectBooleanCheckbox id="transactionMode" value="#{userGroupEdit.transactionMode}"
             onchange="
              var d = this.checked ? 'none' : '';
              document.getElementById('editValidHours').style.display=d;
              document.getElementById('validHoursLabel').style.display=d;
              document.getElementById('validityPeriod').style.display=d;
              document.getElementById('validityPeriod.hours').disabled=!this.checked;
              document.getElementById('validityPeriod.minutes').disabled=!this.checked;
              if(this.checked) {
                document.getElementById('editValidHours').checked=false;
                document.getElementById('validityPeriod.hours').value = '';
                document.getElementById('validityPeriod.minutes').value = '';
              }
             "/>

          <h:selectBooleanCheckbox id="editValidHours" value="#{userGroupEdit.editValidityPeriod}" onchange="
          document.getElementById('validityPeriod.hours').disabled=!this.checked;
          document.getElementById('validityPeriod.minutes').disabled=!this.checked;
          "/>
          <h:outputText id="validHoursLabel" style="white-space:nowrap;" value="#{userBundle.validityPeriod}"/>
          <eye:inputDate id="validityPeriod" value="#{userGroupEdit.validityPeriod}" type="short_time"/>

        </h:panelGrid>
      </eye:collapsingGroup>

      <p/>
      
      <eye:collapsingGroup label="#{msg['user.edit.restrictions']}" opened="true">
        <h:panelGrid id="default" style="padding-left:10px; padding-top:10px" columns="3" columnClasses="column20Width,column100Width, columnTopLeftAlign">
          <h:selectBooleanCheckbox id="editSmsPerSec" value="#{userGroupEdit.editSmsPerSec}" onchange="document.getElementById('smsPerSec').disabled=!this.checked"/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.smsPerSec}"/>
          <tr:inputText id="smsPerSec" value="#{userGroupEdit.smsPerSec}" simple="true" columns="5"/>

          <h:selectBooleanCheckbox id="editAllowedRegions" value="#{userGroupEdit.editAllowedRegions}" onchange="
          document.getElementById('allRegions').disabled=!this.checked;
          var i = 0;
          while(true) {
            var el=document.getElementById('regionsSelectMany:_' + i);
            if (el != null &amp;&amp; el != 'undefined') {
              el.disabled=!this.checked;
            } else
              break;
            i++;
          }
          "/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.regions}"/>
          <tr:selectBooleanCheckbox id="allRegions" value="#{userGroupEdit.allRegionsAllowed}" text="#{msg['user.edit.all']}" simple="true" onchange="var el = document.getElementById('regionsSelectMany'); el.style.display = this.checked ? 'none':'';"/>

          <h:outputText style="white-space:nowrap;" value="&#160;"/>
          <h:outputText style="white-space:nowrap;" value="&#160;"/>
          <tr:selectManyCheckbox id="regionsSelectMany" value="#{userGroupEdit.regions}" simple="true" contentStyle="display: #{userGroupEdit.allRegionsAllowed==true ? 'none':''};">
            <f:selectItems value="#{userGroupEdit.regionsList}"/>
          </tr:selectManyCheckbox>

        </h:panelGrid>
      </eye:collapsingGroup>

      <p/>

      <eye:collapsingGroup label="#{msg['user.edit.archive']}" opened="true">

        <h:panelGrid style="padding-left:10px; padding-top:10px" columns="3" columnClasses="column20Width, column100WidthNoWrap, columnTopLeftAlign">
          <h:selectBooleanCheckbox id="editArchivateDeliveries" value="#{userGroupEdit.editArchivateDeliveries}" onchange="
          document.getElementById('createArchive').disabled=!this.checked;
          document.getElementById('deliveryLifetime').disabled=!this.checked;
          "/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.createArchive}"/>
          <h:selectBooleanCheckbox id="createArchive" value="#{userGroupEdit.createArchive}" onchange="document.getElementById('archiveSettings').style.display=this.checked ? '' : 'none'"/>
        </h:panelGrid>

        <h:panelGrid id="archiveSettings" style="padding-left:10px;display: #{userGroupEdit.createArchive ? '':'none'};" columns="3" columnClasses="column20Width,column100WidthNoWrap, columnTopLeftAlign">
          <h:outputText style="white-space:nowrap;" value="&#160;"/>
          <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.delivery.lifetime']}"/>
          <tr:inputText id="deliveryLifetime" value="#{userGroupEdit.deliveryLifetime}" simple="true" columns="5"/>
        </h:panelGrid>
      </eye:collapsingGroup>

      <p/>

      <eye:collapsingGroup label="#{msg['user.edit.billing']}" opened="true">
        <h:panelGrid style="padding-left:10px; padding-top:10px" columns="3" columnClasses="column20Width, column100WidthNoWrap, columnTopLeftAlign">
          <h:selectBooleanCheckbox id="editCreateCdr" value="#{userGroupEdit.editSmsPerSec}" onchange="document.getElementById('createCdr').disabled=!this.checked"/>
          <h:outputText style="white-space:nowrap;" value="#{userBundle.createCDR}"/>
          <h:selectBooleanCheckbox id="createCdr" value="#{userGroupEdit.createCdr}" />
        </h:panelGrid>
      </eye:collapsingGroup>

      <p/>

      <eye:buttons>
        <eye:button>
          <tr:commandLink text="#{msg['done.button']}" action="#{userGroupEdit.save}"/>
        </eye:button>
        <eye:button>
          <tr:commandLink text="#{msg['cancel.button']}" action="USERS" immediate="true"/>
        </eye:button>
        <eye:space/>
      </eye:buttons>

      <script type="text/javascript" language="javascript">
        document.getElementById('organization').disabled = !document.getElementById('editOrganization').checked;
        document.getElementById('admin').disabled = !document.getElementById('editAdmin').checked;
        document.getElementById('blocked').disabled = !document.getElementById('editBlocked').checked;
        document.getElementById('sourceAddr').disabled = !document.getElementById('editSourceAddr').checked;

        var deliveryDaysDisabled = !document.getElementById('editDeliveryDays').checked;
        for (var i = 0; i&lt;7; i++)
            document.getElementById('deliveryDays:' + i).disabled=deliveryDaysDisabled;

        var deliveryStartTimeDisabled = !document.getElementById('editDeliveryStartTime').checked;
        document.getElementById('deliveryStartTime.hours').disabled=deliveryStartTimeDisabled;
        document.getElementById('deliveryStartTime.minutes').disabled=deliveryStartTimeDisabled;

        var deliveryEndTimeDisabled = !document.getElementById('editDeliveryEndTime').checked;
        document.getElementById('deliveryEndTime.hours').disabled=deliveryEndTimeDisabled;
        document.getElementById('deliveryEndTime.minutes').disabled=deliveryEndTimeDisabled;

        document.getElementById('priority').disabled = !document.getElementById('editPriority').checked;

        var retryPolicyDisabled = !document.getElementById('editRetryPolicy').checked;
        document.getElementById('retryPolicy').disabled=retryPolicyDisabled || !document.getElementById('retryOnFail').checked;
        document.getElementById('retryOnFail').disabled=retryPolicyDisabled;

        document.getElementById('smsNotification').disabled = !document.getElementById('editSmsNotification').checked;
        document.getElementById('emailNotification').disabled = !document.getElementById('editEmailNotification').checked;

        document.getElementById('deliveryType').disabled=!document.getElementById('editDeliveryType').checked;
        document.getElementById('transactionMode').disabled=!document.getElementById('editTransactionMode').checked;
        document.getElementById('validityPeriod.hours').disabled=!document.getElementById('editValidHours').checked;
        document.getElementById('validityPeriod.minutes').disabled=!document.getElementById('editValidHours').checked;
        document.getElementById('smsPerSec').disabled=!document.getElementById('editSmsPerSec').checked;

        var allowedRegionsDisabled=!document.getElementById('editAllowedRegions').checked;
        document.getElementById('allRegions').disabled=allowedRegionsDisabled;
        var j = 0;
        while(true) {
          var el=document.getElementById('regionsSelectMany:_' + j);
          if (el != null &amp;&amp; el != 'undefined') {
            el.disabled=allowedRegionsDisabled;
          } else
            break;
          j++;
        }

        var archivateDeliveriesDisabled = !document.getElementById('editArchivateDeliveries').checked;
        document.getElementById('createArchive').disabled=archivateDeliveriesDisabled;
        document.getElementById('deliveryLifetime').disabled=archivateDeliveriesDisabled;

        document.getElementById('createCdr').disabled=!document.getElementById('editCreateCdr').checked;

        var d = document.getElementById('transactionMode').checked ? 'none' : '';
        document.getElementById('editValidHours').style.display=d;
        document.getElementById('validHoursLabel').style.display=d;
        document.getElementById('validityPeriod').style.display=d;
      </script>

    </tr:form>

  </ui:define>

</ui:composition>


</html>
