<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:tr="http://myfaces.apache.org/trinidad"
      xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:eye="http://taglib.eyeline.mobi">

<ui:composition template="/templates/main.xhtml">

  <ui:param name="pageTitle" value="#{msg['cp.resource.edit']}  (#{msg['cp.resource.protocol.ftp']})"/>

  <ui:define name="content">

    <tr:form>

      <eye:message level="#{cpFtpEdit.messageType}" rendered="#{cpFtpEdit.message != null}">
        <h:outputText value="#{cpFtpEdit.message}"/>
      </eye:message>

      <eye:delimiter rendered="#{cpFtpEdit.message != null}"/>

      <h:panelGroup >

        <eye:buttons>
          <eye:button>
            <tr:commandLink text="#{msg['done.button']}" action="#{cpFtpEdit.save}" shortDesc="#{msg['cp.resource.save.desc']}">
              <f:param name="userId" value="#{cpFtpEdit.userId}"/>
            </tr:commandLink>
          </eye:button>
          <eye:button>
            <tr:commandLink text="#{msg['cancel.button']}" action="CP_RESOURCE_LIST" immediate="true" shortDesc="#{msg['cp.resource.cancel.desc']}"/>
          </eye:button>
          <eye:space/>
          <eye:button>
            <tr:commandLink text="#{msg['testconnect.button']}" action="#{cpFtpEdit.verifyConnection}" shortDesc="#{msg['cp.resource.check.desc']}"/>
          </eye:button>
        </eye:buttons>

        <h:inputHidden id="edit" value="#{cpFtpEdit.edit}"/>

        <h:inputHidden id="settings_id" value="#{cpFtpEdit.id}"/>

        <h:panelGrid style="padding-left:10px;" columns="1" columnClasses="columnTopLeftAlign">

          <h:panelGrid columns="2" columnClasses="column100Width, columnTopLeftAlign">
            <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.name']}"/>
            <h:inputText size="200" value="#{cpFtpEdit.settings.name}"/>
          </h:panelGrid>

          <eye:collapsingGroup label="#{msg['cp.resource.connect.settings']}" opened="true">

            <h:panelGrid style="padding-top: 5px;" columns="2" columnClasses="column100Width, columnTopLeftAlign">
              <h:outputText style="white-space:nowrap;" id="host" value="#{msg['user.edit.import.host']}"/>
              <h:inputText id="hostLabel" maxlength="50" value="#{cpFtpEdit.settings.host}"/>

              <h:outputText style="white-space:nowrap;" id="port" value="#{msg['user.edit.import.port']}"/>
              <h:inputText id="portLabel" maxlength="8" value="#{cpFtpEdit.settings.port}"/>

              <h:outputText style="white-space:nowrap;" id="login" value="#{msg['user.edit.import.login']}"/>
              <h:inputText id="loginLabel" maxlength="20" value="#{cpFtpEdit.settings.login}"/>

              <h:outputText style="white-space:nowrap;" id="password" value="#{msg['user.edit.import.password']}"/>
              <h:inputText id="passwordLabel" maxlength="200" value="#{cpFtpEdit.settings.password}"/>

              <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.directory']}"/>
              <h:inputText maxlength="1024" value="#{cpFtpEdit.settings.directory}" size="80"/>

              <h:outputText style="white-space:nowrap;" id="passiveMode" value="#{msg['user.edit.import.passiveMode']}"/>
              <h:selectBooleanCheckbox id="passiveMode" value="#{cpFtpEdit.settings.passiveMode}"/>

            </h:panelGrid>

          </eye:collapsingGroup>

          <eye:collapsingGroup label="#{msg['cp.resource.import.settings']}" opened="true">

            <h:panelGrid style="padding-top: 5px;" columns="2" columnClasses="column100Width, columnTopLeftAlign">

              <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.workType']}"/>
              <h:selectOneMenu id="workType" value="#{cpFtpEdit.workType}" onchange="typeChanged()">
                <f:selectItems value="#{cpFtpEdit.workTypes}"/>
              </h:selectOneMenu>

              <h:outputText style="white-space:nowrap;" id="createReportsLabel" value="#{userBundle.exportReports}"/>
              <h:selectOneMenu id="reportType" value="#{cpFtpEdit.reportType}"  onchange="reportChanged()">
                <f:selectItems value="#{cpFtpEdit.reportTypes}"/>
              </h:selectOneMenu>

              <h:outputText style="white-space: nowrap;" value="#{msg['user.edit.import.reportTimeout']}" id="reportTimeoutLabel"/>
              <h:inputText converterMessage="#{msg['invalid_param_value']} #{msg['user.edit.import.reportTimeout']}" value="#{cpFtpEdit.reportTimeout}" id="reportTimeout"/>

              <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.encoding']}"/>
              <h:selectOneMenu value="#{cpFtpEdit.settings.encoding}">
                <f:selectItems value="#{cpFtpEdit.fileEncodings}"/>
              </h:selectOneMenu>

              <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.activePeriod']}"/>
              <h:panelGroup>
                <eye:inputDate value="#{cpFtpEdit.activePeriodStart}" type="short_time"/>
                <h:outputText value=" - "/>
                <eye:inputDate value="#{cpFtpEdit.activePeriodEnd}" type="short_time"/>
              </h:panelGroup>

              <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.updatePeriodInMin']}"/>
              <h:inputText value="#{cpFtpEdit.settings.periodInMin}" size="10"/>

            </h:panelGrid>

          </eye:collapsingGroup>

          <eye:collapsingGroup label="#{msg['cp.resource.delivery.settings']}" opened="true">
            <h:panelGrid style="padding-top: 5px;" columns="2" columnClasses="column100Width, columnTopLeftAlign">

              <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.user']}"/>

              <h:panelGroup rendered="#{cpFtpEdit.edit}">
                <h:inputHidden id="user_ID" value="#{cpFtpEdit.userId}"/>
                <h:outputText value="#{cpFtpEdit.userId}"/>
              </h:panelGroup>

              <h:selectOneMenu rendered="#{!cpFtpEdit.edit}" value="#{cpFtpEdit.userId}">
                <f:selectItems value="#{cpFtpEdit.uniqueUsers}"/>
              </h:selectOneMenu>

              <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.sourceAddress']}"/>
              <h:inputText converter="addressConverter"  converterMessage="#{msg['invalid_param_value']} #{msg['user.edit.import.sourceAddress']}"
                           value="#{cpFtpEdit.settings.sourceAddress}" maxlength="15"/>
            </h:panelGrid>

          </eye:collapsingGroup>

        </h:panelGrid>

        <eye:delimiter/>

        <eye:buttons>

          <eye:button>
            <tr:commandLink text="#{msg['done.button']}" action="#{cpFtpEdit.save}" shortDesc="#{msg['cp.resource.save.desc']}">
              <f:param name="userId" value="#{cpFtpEdit.userId}"/>
            </tr:commandLink>
          </eye:button>
          <eye:button>
            <tr:commandLink text="#{msg['cancel.button']}" action="CP_RESOURCE_LIST" immediate="true" shortDesc="#{msg['cp.resource.cancel.desc']}"/>
          </eye:button>
          <eye:space/>
          <eye:button>
            <tr:commandLink text="#{msg['testconnect.button']}" action="#{cpFtpEdit.verifyConnection}" shortDesc="#{msg['cp.resource.check.desc']}"/>
          </eye:button>
        </eye:buttons>

      </h:panelGroup>

      <script type="text/javascript" language="javascript">

        function typeChanged() {
          var dt = document.getElementById('workType');
          var disp = dt.options[0].selected ? 'none' : '';
          var e = document.getElementById('reportType');
          if(disp == 'none') {
            e.checked=false;
            document.getElementById('reportTimeout').style.display = 'none';
            document.getElementById('reportTimeoutLabel').style.display = 'none';
          }
          e.style.display = disp;
          document.getElementById('createReportsLabel').style.display = disp;
        }

        function reportChanged() {
          var dt = document.getElementById('reportType');
          var disp = dt.options[2].selected ? '' : 'none';
          var e = document.getElementById('reportTimeout');
          e.style.display = disp;
          document.getElementById('reportTimeoutLabel').style.display = disp;
        }

        typeChanged();
        reportChanged();

      </script>

    </tr:form>

  </ui:define>

</ui:composition>


</html>