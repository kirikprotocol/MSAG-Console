<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:tr="http://myfaces.apache.org/trinidad"
      xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:eye="http://taglib.eyeline.mobi">

<ui:composition template="/templates/main.xhtml">

  <ui:param name="pageTitle" value="#{msg['cp.resource.edit']}"/>

  <ui:define name="content">

    <tr:form>

      <eye:message level="#{cpFileEdit.messageType}" rendered="#{cpFileEdit.message != null}">
        <h:outputText value="#{cpFileEdit.message}"/>
      </eye:message>

      <eye:delimiter/>

      <h:panelGroup >

      <eye:buttons>

        <eye:button>
          <h:commandLink value="#{msg['save.button']}" action="#{cpFileEdit.save}">
            <f:param name="userId" value="#{cpFileEdit.userId}"/>
          </h:commandLink>
        </eye:button>
        <eye:button>
          <h:commandLink value="#{msg['cancel.button']}" action="CP_RESOURCE_LIST" immediate="true"/>
        </eye:button>
        <eye:space/>
        <eye:button>
          <h:commandLink value="#{msg['testconnect.button']}" action="#{cpFileEdit.verifyConnection}"/>
        </eye:button>

      </eye:buttons>

      <eye:delimiter/>

        <h:inputHidden id="edit" value="#{cpFileEdit.edit}"/>

        <h:inputHidden id="settings_id" value="#{cpFileEdit.id}"/>

        <h:panelGrid style="padding-left:10px; padding-top:10px" columns="2"
                     columnClasses="column100Width, columnTopLeftAlign">

          <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.name']}"/>
          <h:inputText value="#{cpFileEdit.settings.name}"/>

          <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.user']}"/>

          <h:panelGroup rendered="#{cpFileEdit.edit}">
            <h:inputHidden id="user_ID" value="#{cpFileEdit.userId}"/>
            <h:outputText value="#{cpFileEdit.userId}"/>
          </h:panelGroup>

          <h:selectOneMenu rendered="#{!cpFileEdit.edit}" value="#{cpFileEdit.userId}">
            <f:selectItems value="#{cpFileEdit.uniqueUsers}"/>
          </h:selectOneMenu>

          <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.directory']}"/>
          <h:inputText maxlength="1024" value="#{cpFileEdit.settings.directory}" size="80"/>

          <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.workType']}"/>
          <h:selectOneMenu id="workType" value="#{cpFileEdit.settings.workType}" onchange="typeChanged()">
            <f:selectItems value="#{cpFileEdit.workTypes}"/>
          </h:selectOneMenu>

          <h:outputText style="white-space:nowrap;" id="createReportsLabel" value="#{userBundle.createReports}"/>
          <h:selectBooleanCheckbox id="createReports" value="#{cpFileEdit.settings.createReports}"/>

          <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.encoding']}"/>
          <h:selectOneMenu value="#{cpFileEdit.settings.encoding}">
            <f:selectItems value="#{cpFileEdit.fileEncodings}"/>
          </h:selectOneMenu>

          <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.sourceAddress']}"/>
          <h:inputText converter="addressConverter"  converterMessage="#{msg['invalid_param_value']}"
                       value="#{cpFileEdit.settings.sourceAddress}" maxlength="15"/>

          <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.activePeriod']}"/>
          <h:panelGroup>
            <eye:inputDate value="#{cpFileEdit.activePeriodStart}" type="short_time"/>
            <h:outputText value=" - "/>
            <eye:inputDate value="#{cpFileEdit.activePeriodEnd}" type="short_time"/>
          </h:panelGroup>

          <h:outputText style="white-space:nowrap;" value="#{msg['user.edit.import.updatePeriodInMin']}"/>
          <h:inputText converterMessage="#{msg['invalid_param_value']}" value="#{cpFileEdit.settings.periodInMin}" size="10"/>

        </h:panelGrid>

        <eye:delimiter/>

        <eye:buttons>

          <eye:button>
            <h:commandLink value="#{msg['save.button']}" action="#{cpFileEdit.save}">
              <f:param name="userId" value="#{cpFileEdit.userId}"/>
            </h:commandLink>
          </eye:button>
          <eye:button>
            <h:commandLink value="#{msg['cancel.button']}" action="CP_RESOURCE_LIST" immediate="true"/>
          </eye:button>
          <eye:space/>
          <eye:button>
            <h:commandLink value="#{msg['testconnect.button']}" action="#{cpFileEdit.verifyConnection}"/>
          </eye:button>

        </eye:buttons>

      </h:panelGroup>

      <script type="text/javascript" language="javascript">

        function typeChanged() {
          var dt = document.getElementById('workType');
          var disp = dt.options[0].selected ? 'none' : '';
          var e = document.getElementById('createReports');
          if(disp == 'none') {
            e.checked=false;
          }
          e.style.display = disp;
          document.getElementById('createReportsLabel').style.display = disp;
        }

        typeChanged();

      </script>

    </tr:form>

  </ui:define>

</ui:composition>


</html>