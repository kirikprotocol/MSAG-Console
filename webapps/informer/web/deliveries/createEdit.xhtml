<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:tr="http://myfaces.apache.org/trinidad"
      xmlns:eye="http://taglib.eyeline.mobi"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:t="http://myfaces.apache.org/tomahawk">


<ui:composition>

  <eye:pageSubtitle value="#{msg['informer.deliveries.create.edit']}"/>

  <tr:form>

    <h:panelGrid columns="2" style="padding-left:10px" columnClasses="column50Width, columnTopLeftAlign">

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.name}"/>
      <tr:inputText value="#{createDelivery.activePage.delivery.name}" required="true" simple="true"/>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.sourceAddress}"/>
      <tr:inputText converter="addressConverter" value="#{createDelivery.activePage.delivery.sourceAddress}" required="true" simple="true"/>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.startDate}"/>
      <t:inputDate popupCalendar="true" value="#{createDelivery.activePage.delivery.startDate}" requiredMessage="#{msg['date.required']}" required="true" type="full"/>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.endDate}"/>
      <t:inputDate popupCalendar="true" value="#{createDelivery.activePage.delivery.endDate}" type="full" />

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.activeWeekDays}"/>
      <h:panelGrid columns="2" columnClasses="column300Width, columnTopLeftAlign">
        <h:selectManyCheckbox value="#{createDelivery.activePage.delivery.activeWeekDays}" required="true" requiredMessage="#{deliveryBundle.activeWeekDays}" converter="weekDaysConverter">
          <f:selectItems value="#{createDelivery.activePage.allDays}"/>
        </h:selectManyCheckbox>
        <h:outputText value="&#160;"/>
      </h:panelGrid>

      <h:outputText style="white-space: nowrap;" value="#{msg['informer.deliveries.create.activePeriod']}"/>
      <h:panelGroup>
        <t:inputDate value="#{createDelivery.activePage.delivery.activePeriodStart}" requiredMessage="#{msg['date.required']}" required="true" type="time"/>
        <h:outputText style="white-space: nowrap;" value=" - "/>
        <t:inputDate value="#{createDelivery.activePage.delivery.activePeriodEnd}" requiredMessage="#{msg['date.required']}" required="true" type="time"/>
      </h:panelGroup>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.retryOnFail}"/>
      <h:panelGroup>
        <h:selectBooleanCheckbox id="retryOnFail" value="#{createDelivery.activePage.delivery.retryOnFail}" onchange="document.getElementById('retryPolicy1').disabled = !this.checked;"/>
        <h:inputText value="#{createDelivery.activePage.delivery.retryPolicy}" id="retryPolicy1"/>
      </h:panelGroup>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.priority}"/>
      <tr:inputText value="#{createDelivery.activePage.delivery.priority}" simple="true" required="true">
        <tr:validateLongRange minimum="1" maximum="1000"/>
      </tr:inputText>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.smsNotificationAddress}"/>
      <h:panelGroup>
        <h:selectBooleanCheckbox id="smsNotif" value="#{createDelivery.activePage.smsNotificationCheck}" onchange="document.getElementById('sms').disabled = !this.checked;"/>
        <h:inputText id="sms" converter="addressConverter" value="#{createDelivery.activePage.smsNotificationAddress}"/>
      </h:panelGroup>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.emailNotificationAddress}"/>
      <h:panelGroup>
        <h:selectBooleanCheckbox id="emailNotif" value="#{createDelivery.activePage.emailNotificationCheck}" onchange="document.getElementById('email').disabled = !this.checked;"/>
        <h:inputText id="email"  value="#{createDelivery.activePage.emailNotificationAddress}"/>
      </h:panelGroup>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.singleText}" rendered="#{createDelivery.activePage.delivery.type.value == 'SingleText'}"/>
      <h:panelGroup rendered="#{createDelivery.activePage.delivery.type.value == 'SingleText'}">
        <tr:inputText rows="5" value="#{createDelivery.activePage.delivery.singleText}" required="true" simple="true"/>
          <tr:outputText value="&#160;"/>
          <tr:commandLink text="#{msg['test.button']}" action="#{createDelivery.activePage.sendTest}"/>
      </h:panelGroup>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.deliveryMode}"/>
      <h:selectOneMenu id="dMode" value="#{createDelivery.activePage.delivery.deliveryMode}" required="true" converter="deliveryTypeConverter"
                       onchange="
                       var disp = this.options[0].selected ? '' : 'none';
                       document.getElementById('flashLabel').style.display=disp;
                       document.getElementById('flash').style.display=disp;
                       document.getElementById('trModeLabel').style.display=disp;
                       document.getElementById('trMode').style.display=disp;

                       disp = (this.options[0].selected &amp;&amp; document.getElementById('trMode').checked) ? '' : 'none';
                       document.getElementById('vPeriodLabel').style.display=disp;
                       document.getElementById('vPeriod').style.display=disp;
                       ">
        <f:selectItems value="#{createDelivery.activePage.uniqueDeliveryModes}"/>
      </h:selectOneMenu>

      <h:outputText id="flashLabel" style="white-space: nowrap;" value="#{deliveryBundle.flash}"/>
      <h:selectBooleanCheckbox id="flash" value="#{createDelivery.activePage.delivery.flash}"/>

      <h:outputText id="trModeLabel" style="white-space: nowrap;" value="#{deliveryBundle.transactionMode}"/>
      <tr:selectBooleanCheckbox id="trMode" value="#{createDelivery.activePage.delivery.transactionMode}" simple="true"
                                    onchange="
                                    disp = (document.getElementById('dMode').options[0].selected &amp;&amp; this.checked) ? '' : 'none';
                                    document.getElementById('vPeriodLabel').style.display=disp;
                                    document.getElementById('vPeriod').style.display=disp;
                                    "/>

      <h:outputText id="vPeriodLabel" style="white-space: nowrap;" value="#{deliveryBundle.validityPeriod}"/>
      <tr:inputText id="vPeriod" value="#{createDelivery.activePage.delivery.validityPeriod}" simple="true">
        <tr:validateLongRange minimum="1" maximum="100"/>
      </tr:inputText>

    </h:panelGrid>

    <eye:delimiter/>

    <eye:buttons>
      <eye:button>
        <tr:commandLink text="#{msg['cancel.button']}" action="#{createDelivery.cancel}" immediate="true"/>
      </eye:button>
      <eye:button>
        <tr:commandLink text="#{msg['next.button']} &gt;" action="#{createDelivery.next}"/>
      </eye:button>
      <eye:space/>
    </eye:buttons>

    <script type="text/javascript" language="javascript">
      document.getElementById('retryPolicy1').disabled = !document.getElementById('retryOnFail').checked;
      document.getElementById('sms').disabled = !document.getElementById('smsNotif').checked;
      document.getElementById('email').disabled = !document.getElementById('emailNotif').checked;

      var disp = document.getElementById('dMode').options[0].selected ? '' : 'none';
      document.getElementById('flashLabel').style.display=disp;
      document.getElementById('flash').style.display=disp;
      document.getElementById('trModeLabel').style.display=disp;
      document.getElementById('trMode').style.display=disp;

      disp = (document.getElementById('dMode').options[0].selected &amp;&amp; document.getElementById('trMode').checked) ? '' : 'none';  
      document.getElementById('vPeriodLabel').style.display=disp;
      document.getElementById('vPeriod').style.display=disp;
    </script>

  </tr:form>

</ui:composition>


</html>