<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:tr="http://myfaces.apache.org/trinidad"
      xmlns:eye="http://taglib.eyeline.mobi"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:t="http://myfaces.apache.org/tomahawk">


<ui:composition>

  <eye:pageSubtitle value="#{msg['informer.deliveries.create.edit']}"/>

  <tr:form>

    <h:panelGrid columns="2" style="padding-left:10px" columnClasses="column50Width, columnTopLeftAlign">

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.name}"/>
      <tr:inputText value="#{createDelivery.activePage.delivery.name}" simple="true"/>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.sourceAddress}"/>
      <h:inputText converterMessage="#{msg['invalid_param_value']} #{deliveryBundle.sourceAddress}" converter="addressConverter" value="#{createDelivery.activePage.delivery.sourceAddress}"/>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.startDate}"/>
      <eye:inputDate value="#{createDelivery.activePage.delivery.startDate}" type="both"/>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.endDate}"/>
      <eye:inputDate value="#{createDelivery.activePage.delivery.endDate}" type="both" />

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.activeWeekDays}"/>
      <h:panelGrid columns="2" columnClasses="column300Width, columnTopLeftAlign">
        <h:selectManyCheckbox converterMessage="#{msg['invalid_param_value']} #{deliveryBundle.activeWeekDays}" value="#{createDelivery.activePage.delivery.activeWeekDays}" converter="weekDaysConverter">
          <f:selectItems value="#{createDelivery.activePage.allDays}"/>
        </h:selectManyCheckbox>
        <h:outputText value="&#160;"/>
      </h:panelGrid>

      </h:panelGrid>

      <h:panelGrid columns="2" style="padding-left:10px" columnClasses="column50Width, columnTopLeftAlign" rendered="#{createDelivery.activePage.userInAdminRole}">

      <h:outputText style="white-space: nowrap;" value="#{msg['informer.deliveries.create.activePeriod']}"/>
      <h:panelGroup>
        <eye:inputDate value="#{createDelivery.activePage.activePeriodStart}" type="short_time"/>
        <h:outputText style="white-space: nowrap;" value=" - "/>
        <eye:inputDate value="#{createDelivery.activePage.activePeriodEnd}" type="short_time"/>
      </h:panelGroup>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.priority}"/>
      <h:inputText converterMessage="#{msg['invalid_param_value']} #{deliveryBundle.priority}"
                   value="#{createDelivery.activePage.delivery.priority}"/>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.retryOnFail}"/>
      <h:panelGroup>
        <h:selectOneMenu id="retryOnFail" onchange="retryOnFailChanged()" value="#{createDelivery.activePage.retryOnFail}">
            <f:selectItem itemValue="off" itemLabel="#{msg['user.edit.retry.off']}"/>
            <f:selectItem itemValue="default" itemLabel="#{msg['user.edit.retry.default']}"/>
            <f:selectItem itemValue="custom" itemLabel="#{msg['user.edit.retry.custom']}"/>
          </h:selectOneMenu>
          <h:outputText value=" "/>
        <h:inputText value="#{createDelivery.activePage.delivery.retryPolicy}" id="retryPolicy1"/>
      </h:panelGroup>

      <h:outputText id="vPeriodLabel" style="white-space: nowrap;" value="#{deliveryBundle.validityPeriod}"/>
      <eye:inputDate id="vPeriod" value="#{createDelivery.activePage.validityPeriod}" type="short_time"/>

      <h:outputText id="trModeLabel" style="white-space: nowrap;" value="#{deliveryBundle.transactionMode}"/>
      <tr:selectBooleanCheckbox id="trMode" value="#{createDelivery.activePage.delivery.transactionMode}" simple="true"/>


      </h:panelGrid>

      <h:panelGrid columns="2" style="padding-left:10px" columnClasses="column50Width, columnTopLeftAlign">

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.smsNotificationAddress}"/>
      <h:panelGroup>
        <h:selectBooleanCheckbox id="smsNotif" value="#{createDelivery.activePage.smsNotificationCheck}" onchange="document.getElementById('sms').disabled = !this.checked;"/>
        <h:inputText converterMessage="#{msg['invalid_param_value']} #{deliveryBundle.smsNotificationAddress}" id="sms" converter="addressConverter" value="#{createDelivery.activePage.smsNotificationAddress}"/>
      </h:panelGroup>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.emailNotificationAddress}"/>
      <h:panelGroup>
        <h:selectBooleanCheckbox id="emailNotif" value="#{createDelivery.activePage.emailNotificationCheck}" onchange="document.getElementById('email').disabled = !this.checked;"/>
        <h:inputText id="email"  value="#{createDelivery.activePage.emailNotificationAddress}"/>
      </h:panelGroup>

      <h:outputText style="white-space: nowrap;" value="#{deliveryBundle.singleText}" rendered="#{createDelivery.activePage.deliveryWithSingleText}"/>
      <h:panelGroup rendered="#{createDelivery.activePage.deliveryWithSingleText}">
        <tr:inputText rows="5" value="#{createDelivery.activePage.delivery.singleText}" simple="true"/>
          <tr:outputText value="&#160;"/>
          <tr:commandLink text="#{msg['test.button']}" action="#{createDelivery.activePage.sendTest}"/>
      </h:panelGroup>

      <h:outputText style="white-space: nowrap;display: #{createDelivery.allowUssdPushDelivery ? '' : 'none'}" value="#{deliveryBundle.deliveryMode}"/>
      <h:selectOneMenu id="dMode" value="#{createDelivery.activePage.delivery.deliveryMode}"
                       converterMessage="#{msg['invalid_param_value']} #{deliveryBundle.deliveryMode}"
                       converter="deliveryTypeConverter"
                       onchange="
                       var disp = this.options[0].selected ? '' : 'none';
                       document.getElementById('flashLabel').style.display=disp;
                       document.getElementById('flash').style.display=disp;
                       document.getElementById('trModeLabel').style.display=disp;
                       document.getElementById('trMode').style.display=disp;

                       " style="display: #{createDelivery.allowUssdPushDelivery ? '' : 'none'}">
        <f:selectItems value="#{createDelivery.activePage.uniqueDeliveryModes}"/>
      </h:selectOneMenu>

      <h:outputText id="flashLabel" style="white-space: nowrap;" value="#{deliveryBundle.flash}"/>
      <h:selectBooleanCheckbox id="flash" value="#{createDelivery.activePage.delivery.flash}"/>

    </h:panelGrid>

    <eye:delimiter/>

    <eye:buttons>
      <eye:button>
        <tr:commandLink text="#{msg['cancel.button']}" action="#{createDelivery.cancel}" immediate="true" shortDesc="#{msg['delivery.create.details.cancel']}"/>
      </eye:button>
      <eye:button>
        <tr:commandLink text="#{msg['next.button']} &gt;" action="#{createDelivery.next}"/>
      </eye:button>
      <eye:space/>
    </eye:buttons>

    <script type="text/javascript" language="javascript">
      function retryOnFailChanged() {
        var d = document.getElementById('retryOnFail').options[2].selected ? '' : 'none';
        document.getElementById('retryPolicy1').style.display=d;
      }

      retryOnFailChanged();

      document.getElementById('sms').disabled = !document.getElementById('smsNotif').checked;
      document.getElementById('email').disabled = !document.getElementById('emailNotif').checked;

      var disp = document.getElementById('dMode').options[0].selected ? '' : 'none';
      document.getElementById('flashLabel').style.display=disp;
      document.getElementById('flash').style.display=disp;
      document.getElementById('trModeLabel').style.display=disp;
      document.getElementById('trMode').style.display=disp;

    </script>

  </tr:form>

</ui:composition>


</html>