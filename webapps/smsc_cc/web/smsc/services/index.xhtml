<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:eye="http://jsfcomponents.eyeline.mobi">

<ui:composition template="/templates/main.xhtml">

  <ui:param name="pageTitle" value="#{msg['services.page.title']}"/>

  <ui:define name="styles">
    .statusColumn {white-space: nowrap}

    .editColumn {width: 1%}
    .connectedColumn {width: 1%}
    .systemIdColumn {width: 48%}
    .enabledColumn {width: 1px; text-align: center}
    .statusColumn {width: 100%; text-align: center}
  </ui:define>

  <ui:define name="content">

    <h:form id="services" rendered="#{!service.outOfDate}">

      <eye:dataTableFilter applyAction="#{service.apply}" clearAction="#{service.clear}">
        <h:panelGrid columns="2" columnClasses="labelColumn, valueColumn" style="width: 300px">
          <h:outputText style="white-space: nowrap" value="#{msg['service.edit.page.systemId']}"/>
          <eye:inputText value="#{service.nameFilter}"/>
        </h:panelGrid>
      </eye:dataTableFilter>

      <eye:dataTable value="#{service.services}" var="srv" selectedRows="#{service.selectedRows}">

        <eye:row innerData="#{srv.connectedDirectly}">

          <eye:column name="edit" title="" columnClass="editColumn">
            <h:commandLink action="SERVICE_EDIT" value="#{msg['services.page.edit']}">
              <f:param name="smeId" value="#{srv.systemId}"/>
            </h:commandLink>
          </eye:column>

          <eye:column name="connected" title="" sortable="false" columnClass="connectedColumn">
            <h:graphicImage value="/images/ic_internal.gif" rendered="#{srv.connected}" title="#{msg['services.page.sme.connected']}"/>
            <h:graphicImage value="/images/ic_disconnct.gif" rendered="#{not srv.connected}" title="#{msg['services.page.sme.disconnected']}"/>
          </eye:column>

          <eye:column name="enabled" title="" sortable="false" columnClass="enabledColumn">
            <h:graphicImage value="/images/ic_checked.gif" rendered="#{!srv.disabled}" title="#{msg['services.page.sme.enabled']}"/>
            <h:graphicImage value="/images/ic_not_checked.gif" rendered="#{srv.disabled}" title="#{msg['services.page.sme.disabled']}"/>
          </eye:column>

          <eye:column name="systemId" title="#{msg['services.page.systemId']}" sortable="true" columnClass="systemIdColumn" defaultSortOrder="asc">
            <h:outputText value="#{srv.systemId}"/>
          </eye:column>

          <eye:column name="status" title="#{msg['services.page.connected_to']}" columnClass="statusColumn">
            <h:outputText value="Via LoadBalancer: #{srv.loadBalancerStatus}" rendered="#{srv.connectedViaLoadBalancer}" style="color: GREEN"/>
            <h:outputText value="Directly to SMSCs" rendered="#{srv.connectedDirectly}" style="color: GREEN"/>
            <h:outputText value="Internal" rendered="#{srv.internal}" style="color: GREEN"/>
          </eye:column>

          <f:facet name="innerData">
              <h:panelGroup>
              <c:forEach items="#{srv.directStatuses}" var="st">
                <h:outputText value="SMSC #{st}" style="color:GREEN"/><br/>
              </c:forEach>
            </h:panelGroup>
            </f:facet>
        </eye:row>

      </eye:dataTable>

      <eye:buttons>
        <eye:button><h:commandLink action="SERVICE_EDIT" value="#{msg['add.button']}"/></eye:button>
        <eye:button>
          <eye:menubar label="#{msg['services.page.selected.services']}...">
            <eye:menubaritem><h:commandLink action="#{service.deleteSmes}" value="#{msg['delete.button']}" onclick="if (!confirm('#{msg['smsc.delete.records']}')) return false"/></eye:menubaritem>
            <eye:menubaritem><h:commandLink action="#{service.disconnectSmes}" value="#{msg['services.page.disconnect']}"  onclick="if (!confirm('#{msg['smsc.services.disconnect.confirm']}')) return false"/></eye:menubaritem>
          </eye:menubar>
        </eye:button>
        <eye:space/>

      </eye:buttons>

    </h:form>

  </ui:define>

</ui:composition>


</html>