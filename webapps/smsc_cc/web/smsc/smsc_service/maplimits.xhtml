<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:eye="http://jsfcomponents.eyeline.mobi"
      xmlns:smsc="http://taglib.smsc.mobi"
      xmlns:c="http://java.sun.com/jstl/core">

<ui:composition template="/templates/main.xhtml">

  <ui:param name="pageTitle" value="#{msg['smsc.smsc.map_limit']}"/>

  <ui:define name="styles">
    .labelColumn {width: 1px; white-space: nowrap; text-align: right;}
    .valueColumn {width:100%; text-align: left;}
  </ui:define>

  <ui:define name="content">

    <h:form rendered="#{!mapLimits.initFailed}">

      <eye:buttons>
        <eye:button><smsc:submitButton bean="#{mapLimits}" action="save"/></eye:button>
        <eye:button><smsc:resetButton bean="#{mapLimits}" action="reset"/></eye:button>
        <eye:space/>
      </eye:buttons>

      <h:inputHidden value="#{mapLimits.revision}"/>
      <eye:message level="warn" rendered="#{mapLimits.settingsChanged}"><h:outputText
          value="#{msg['smsc.submit.hint']}"/></eye:message>

      <h:panelGrid columns="1" style="padding:20px;">

        <eye:collapsingGroup label="#{msg['smsc.maplimits.dialogsLimits']}" opened="true">

          <h:panelGrid columns="2" columnClasses="labelColumn, valueColumn">
            <h:outputText value="#{mapLimitBundle.dlgLimitIn}"/>
            <eye:inputText value="#{mapLimits.mlSettings.dlgLimitIn}" required="true">
              <smsc:validatePositive/>
            </eye:inputText>

            <h:outputText value="#{mapLimitBundle.dlgLimitInSri}"/>
            <eye:inputText value="#{mapLimits.mlSettings.dlgLimitInSri}" required="true">
              <smsc:validatePositive/>
            </eye:inputText>

            <h:outputText value="#{mapLimitBundle.dlgLimitInUssd}"/>
            <eye:inputText value="#{mapLimits.mlSettings.dlgLimitInUssd}" required="true">
              <smsc:validatePositive/>
            </eye:inputText>

            <h:outputText value="#{mapLimitBundle.dlgLimitOutSri}"/>
            <eye:inputText value="#{mapLimits.mlSettings.dlgLimitOutSri}" required="true">
              <smsc:validatePositive/>
            </eye:inputText>

            <h:outputText value="#{mapLimitBundle.dlgLimitUssd}"/>
            <eye:inputText value="#{mapLimits.mlSettings.dlgLimitUssd}" required="true">
              <smsc:validatePositive/>
            </eye:inputText>
          </h:panelGrid>

        </eye:collapsingGroup>

        <eye:collapsingGroup label="#{mapLimitBundle.ussdNoSriCodes}" opened="true">
          <h:panelGrid columns="1" style="width:20%">
            <eye:dynamicTable value="#{mapLimits.codes}">
              <eye:textColumn name="code" allowEditAfterAdd="true"/>
            </eye:dynamicTable>
          </h:panelGrid>
        </eye:collapsingGroup>

        <eye:collapsingGroup label="#{mapLimitBundle.congestionLevels}" opened="true">
          <h:panelGroup>
            <c:set var="i" value="0"/>
            <c:forEach var="var" items="#{mapLimits.mlSettings.congestionLevels}">
              <c:set var="i" value="#{i+1}"/>
              <eye:collapsingGroup label="#{msg['smsc.maplimits.level']} #{i}" opened="true">
                <h:panelGrid columns="2" columnClasses="labelCOlumn, valueColumn">
                  <h:outputText value="#{mapLimitCongLvlBundle.dialogsLimit}"/>
                  <eye:inputText value="#{var.dialogsLimit}" required="true">
                    <smsc:validatePositive/>
                  </eye:inputText>

                  <h:outputText value="#{mapLimitCongLvlBundle.failLowerLimit}"/>
                  <eye:inputText value="#{var.failLowerLimit}" required="true">
                    <smsc:validatePositive/>
                  </eye:inputText>

                  <h:outputText value="#{mapLimitCongLvlBundle.failUpperLimit}"/>
                  <eye:inputText value="#{var.failUpperLimit}" required="true">
                    <smsc:validatePositive/>
                  </eye:inputText>

                  <h:outputText value="#{mapLimitCongLvlBundle.okToLower}"/>
                  <eye:inputText value="#{var.okToLower}" required="true">
                    <smsc:validatePositive/>
                  </eye:inputText>
                </h:panelGrid>
              </eye:collapsingGroup>
            </c:forEach>
          </h:panelGroup>
        </eye:collapsingGroup>

      </h:panelGrid>


      <eye:buttons>
        <eye:button><smsc:submitButton bean="#{mapLimits}" action="save"/></eye:button>
        <eye:button><smsc:resetButton bean="#{mapLimits}" action="reset"/></eye:button>
        <eye:space/>
      </eye:buttons>


    </h:form>


  </ui:define>

</ui:composition>


</html>
