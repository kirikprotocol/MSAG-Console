<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:c="http://java.sun.com/jstl/core"
      xmlns:eye="http://jsfcomponents.eyeline.mobi"
      xmlns:smsc="http://taglib.smsc.mobi">

<ui:composition template="/templates/main.xhtml">

  <ui:param name="pageTitle" value="#{msg['route.edit.page.title']}"/>

  <ui:define name="styles">
    .leftColumn {width:500px;vertical-align:top;}
    .rightColumn {vertical-align:top; text-align:left;}
    .labelColumn {width: 1px; text-align:right; white-space: nowrap;}
    .valueColumn {text-align: left;}
    .column1 {width: 300px;}
    .column2 {width: 1px;}
    .column3 {width: 400px;}
    .column4 {width: 300px;}
    .column5 {width: 150px;}

    .sourceMaskColumn {width: 90%}
    .destMaskColumn {width:300px;}
    .destSmeColumn {width:150px;}
  </ui:define>

  <ui:define name="content">

    <h:form rendered="#{!routeEdit.initFailed}">

      <c:set var="r" value="#{routeEdit.route}"/>

      <eye:buttons>
        <eye:button><h:commandLink value="#{msg['done.button']}" action="#{routeEdit.save}"/></eye:button>
        <eye:button><h:commandLink value="#{msg['cancel.button']}" action="ROUTES" immediate="true"/></eye:button>
        <eye:space/>
      </eye:buttons>

      <p/>

      <h:panelGrid columns="2" columnClasses="leftColumn, rightColumn">

        <smsc:pageSubtitle value="#{msg['route.edit.page.route.info']}"/>

        <smsc:pageSubtitle value="#{msg['route.edit.page.route.options']}"/>

        <h:panelGrid columns="2" columnClasses="labelColumn, valueColumn"> <!-- ROUTE INFO -->
          <h:outputText style="white-space: nowrap" value="#{route['name']}"/>
          <eye:inputText id="route" value="#{r.name}" required="true"/>

          <h:outputText style="white-space: nowrap" value="#{route['notes']}"/>
          <eye:inputText value="#{r.notes}" rows="2" cols="15"/>

          <h:outputText style="white-space: nowrap" value="#{route['priority']}"/>
          <eye:inputText value="#{r.priority}"/>

          <h:outputText style="white-space: nowrap" value="#{route['serviceId']}"/>
          <eye:inputText value="#{r.serviceId}"/>

          <h:outputText style="white-space: nowrap" value="#{route['deliveryMode']}"/>
          <h:selectOneMenu value="#{r.deliveryMode}">
            <f:selectItems value="#{routeEdit.deliveryModes}"/>
          </h:selectOneMenu>

          <h:outputText style="white-space: nowrap" value="#{route['srcSmeId']}"/>
          <h:selectOneMenu value="#{routeEdit.srcSme}">
            <f:selectItems value="#{routeEdit.smes}"/>
          </h:selectOneMenu>

          <h:outputText style="white-space: nowrap" value="#{route['providerId']}"/>
          <h:selectOneMenu value="#{routeEdit.provider}">
            <f:selectItems value="#{routeEdit.providers}"/>
          </h:selectOneMenu>

          <h:outputText style="white-space: nowrap" value="#{route['categoryId']}"/>
          <h:selectOneMenu value="#{routeEdit.category}">
            <f:selectItems value="#{routeEdit.categories}"/>
          </h:selectOneMenu>

          <h:outputText style="white-space: nowrap" value="#{route['forwardTo']}"/>
          <eye:inputText value="#{r.forwardTo}"/>

          <h:outputText style="white-space: nowrap" value="#{route['aclId']}"/>
          <h:selectOneMenu value="#{routeEdit.acl}">
            <f:selectItems value="#{routeEdit.acls}"/>
          </h:selectOneMenu>

          <h:outputText style="white-space: nowrap" value="#{route['replayPath']}"/>
          <h:selectOneMenu value="#{r.replayPath}">
            <f:selectItems value="#{routeEdit.replayPaths}"/>
          </h:selectOneMenu>

          <h:outputText style="white-space: nowrap" value="#{route['backupSmeId']}"/>
          <h:selectOneMenu value="#{routeEdit.backupSme}">
            <f:selectItems value="#{routeEdit.smesWithEmpty}"/>
          </h:selectOneMenu>
        </h:panelGrid>

        <h:panelGrid columns="2" columnClasses="labelColumn, valueColumn" style="padding-left:15px;"> <!-- ROUTE OPTIONS -->
          <h:outputText style="white-space: nowrap" value="#{route['active']}"/>
          <h:selectBooleanCheckbox value="#{r.active}"/>
          <h:outputText style="white-space: nowrap" value="#{route['archiving']}"/>
          <h:selectBooleanCheckbox value="#{r.archiving}"/>
          <h:outputText style="white-space: nowrap" value="#{route['suppressDeliveryReports']}"/>
          <h:selectBooleanCheckbox value="#{r.suppressDeliveryReports}"/>
          <h:outputText style="white-space: nowrap" value="#{route['hide']}"/>
          <h:selectBooleanCheckbox value="#{r.hide}"/>
          <h:outputText style="white-space: nowrap" value="#{route['forceDelivery']}"/>
          <h:selectBooleanCheckbox value="#{r.forceDelivery}"/>
          <h:outputText style="white-space: nowrap" value="#{route['transit']}"/>
          <h:selectBooleanCheckbox value="#{r.transit}"/>
          <h:outputText style="white-space: nowrap" value="#{route['billing']}"/>
          <h:selectOneMenu value="#{r.billing}">
            <f:selectItems value="#{routeEdit.billingModes}"/>
          </h:selectOneMenu>
          <h:outputText style="white-space: nowrap" value="#{route['trafficMode']}"/>
          <h:selectOneMenu value="#{r.trafficMode}">
            <f:selectItems value="#{routeEdit.trafficModes}"/>
          </h:selectOneMenu>
        </h:panelGrid>

      </h:panelGrid>

      <hr/>

      <h:panelGrid columns="2" columnClasses="leftColumn, rightColumn">

        <h:panelGrid columns="2" columnClasses="column1, rightColumn">  <!-- SOURCES -->
          <smsc:pageSubtitle value="#{msg['route.edit.page.source.masks']}"/>
          <h:outputText value="&#160;"/>

          <eye:dynamicTable value="#{routeEdit.sourceMasks}">
            <eye:textColumn name="mask" allowEditAfterAdd="false" columnClass="sourceMaskColumn"/>
          </eye:dynamicTable>
          <h:outputText value="&#160;"/>

          <smsc:pageSubtitle value="#{msg['route.edit.page.source.subjects']}"/>
          <h:outputText value="&#160;"/>

          <h:panelGrid columns="2" columnClasses="sourceMaskColumn, column2" rowClasses="listTableRow0, listTableRow1">
            <c:forEach items="#{routeEdit.sourceSubjects}" var="sourceSubject">
              <h:commandLink value="#{sourceSubject}" action="SUBJECT_EDIT">
                <f:param name="oldName" value="#{sourceSubject}"/>
              </h:commandLink>
              <h:commandLink action="#{routeEdit.removeSourceSubject}">
                <h:graphicImage value="/images/but_del.gif" style="position:relative;"/>
                <f:param name="sourceSubject2remove" value="#{sourceSubject}"/>
              </h:commandLink>
            </c:forEach>

            <h:selectOneMenu styleClass="selectW" value="#{routeEdit.sourceSubjectToAdd}">
              <f:selectItems value="#{routeEdit.sourceSubjects2Add}"/>
            </h:selectOneMenu>
            <h:commandLink action="#{routeEdit.addSourceSubject}">
              <h:graphicImage value="/images/but_add.gif" style="position:relative; border:none;"/>
            </h:commandLink>
          </h:panelGrid>
          <h:outputText value="&#160;"/>
        </h:panelGrid>


        <h:panelGrid columns="2" columnClasses="column3, rightColumn"> <!-- DESTINATIONS -->
          <smsc:pageSubtitle value="#{msg['route.edit.page.destination.masks']}"/>
          <h:outputText value="&#160;"/>

          <eye:dynamicTable value="#{routeEdit.destinationMasks}" >
            <eye:textColumn name="mask" allowEditAfterAdd="false" columnClass="destMaskColumn" />
            <eye:selectColumn values="#{routeEdit.smeIds}" name="sme" columnClass="destSmeColumn" allowEditAfterAdd="false"/>
          </eye:dynamicTable>
          <h:outputText value="&#160;"/>

          <smsc:pageSubtitle value="#{msg['route.edit.page.destination.subjects']}"/>
          <h:outputText value="&#160;"/>

          <h:panelGrid columns="3" columnClasses="destMaskColumn, destSmeColumn, rightColumn" rowClasses="listTableRow0, listTableRow1">

            <c:forEach items="#{routeEdit.destinations}" var="dst">
              <h:commandLink value="#{dst.subject}" action="SUBJECT_EDIT"><f:param name="oldName"
                                                                                   value="#{dst.subject}"/></h:commandLink>
              <h:outputText value="#{dst.smeId}"/>
              <h:commandLink action="#{routeEdit.removeDestinationSubject}">
                <h:graphicImage value="/images/but_del.gif" style="position:relative;"/>
                <f:param name="destinationSubject2remove" value="#{dst.subject}"/>
              </h:commandLink>
            </c:forEach>

            <h:selectOneMenu style="width:100%" value="#{routeEdit.destinationSubjectToAdd}">
              <f:selectItems value="#{routeEdit.destinationSubjects2Add}"/>
            </h:selectOneMenu>
            <h:selectOneMenu style="width:100%" value="#{routeEdit.destinationSmeToAdd}">
              <f:selectItems value="#{routeEdit.smes}"/>
            </h:selectOneMenu>
            <h:commandLink action="#{routeEdit.addDestinationSubject}">
              <h:graphicImage value="/images/but_add.gif" style="position:relative; border:none;"/>
            </h:commandLink>
          </h:panelGrid>
        </h:panelGrid>

      </h:panelGrid>

      <p/>

      <eye:buttons>
        <eye:button><h:commandLink value="#{msg['done.button']}" action="#{routeEdit.save}"/></eye:button>
        <eye:button><h:commandLink value="#{msg['cancel.button']}" action="ROUTES" immediate="true"/></eye:button>
        <eye:space/>
      </eye:buttons>

    </h:form>

  </ui:define>

</ui:composition>


</html>