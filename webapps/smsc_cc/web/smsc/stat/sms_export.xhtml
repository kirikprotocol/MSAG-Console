<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:eye="http://jsfcomponents.eyeline.mobi"
      xmlns:smsc="http://taglib.smsc.mobi">

<ui:composition template="/templates/main.xhtml">

  <ui:param name="pageTitle" value="#{msg['smsc.sms.export']}"/>

  <ui:define name="styles">
    .labelColumn {width: 1px; text-align:left; white-space: nowrap;}
    .lastColumn {text-align: left; white-space: nowrap;}

    .preprogress {
    width: 2%;
    }

    .progress {
    width: 40%;
    }

    .postprogress {
    width: 58%;
    }

  </ui:define>


  <ui:define name="content">

    <h:form id="export">

      <eye:message level="warn" rendered="#{smsExportStat.filterError != null}">
        <h:outputText value="#{smsExportStat.filterError}"/>
      </eye:message>

      <h:panelGrid style="padding: 10px 10px 10px 10px" columns="2" columnClasses="labelColumn, lastColumn" rendered="#{smsExportStat.showFilter}">

        <h:outputText value="#{msg['smsc.sms.export.types']}"/>
        <h:selectOneMenu id="storageType" value="#{smsExportStat.storageType}" onchange="changeType()">
          <f:selectItems value="#{smsExportStat.storageTypes}"/>
        </h:selectOneMenu>

        <h:outputText id="date_label" value="#{msg['smsc.export.date']}"/>
        <h:panelGroup id="date">
          <eye:inputDate value="#{smsExportStat.date}"/>
        </h:panelGroup>

        <h:outputText value="#{msg['smsc.stat.export.dest.title']}"/>
        <h:selectOneRadio id="type" value="#{smsExportStat.type}" onclick="changeType()"  style="width:400px">
          <f:selectItems value="#{smsExportStat.types}"/>
        </h:selectOneRadio>

        <h:outputText value="#{exportSetBundle.source}"/>
        <h:panelGroup>
          <h:outputText id="def_arch_source" value="#{smsExportStat.defArchExportSettings.source}"/>
          <h:outputText id="def_oper_source" value="#{smsExportStat.defOperExportSettings.source}"/>
          <eye:inputText id="cus_source" cols="50" value="#{smsExportStat.settings.source}"/>
        </h:panelGroup>

        <h:outputText value="#{exportSetBundle.user}"/>
        <h:panelGroup>
          <h:outputText id="def_arch_user" value="#{smsExportStat.defArchExportSettings.user}"/>
          <h:outputText id="def_oper_user" value="#{smsExportStat.defOperExportSettings.user}"/>
          <eye:inputText id="cus_user" value="#{smsExportStat.settings.user}"/>
        </h:panelGroup>

        <h:outputText value="#{exportSetBundle.pass}"/>
        <h:panelGroup>
          <h:outputText id="def_arch_pass" value="&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;"/>
          <h:outputText id="def_oper_pass" value="&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;"/>
          <eye:inputText secret="true" id="cus_pass" value="#{smsExportStat.settings.pass}"/>
        </h:panelGroup>

        <h:outputText value="#{exportSetBundle.prefix}"/>
        <h:panelGroup>
          <h:outputText id="def_arch_prefix" value="#{smsExportStat.defArchExportSettings.prefix}"/>
          <h:outputText id="def_oper_prefix" value="#{smsExportStat.defOperExportSettings.prefix}"/>
          <eye:inputText id="cus_prefix" value="#{smsExportStat.settings.prefix}"/>
        </h:panelGroup>

      </h:panelGrid>

      <p/>

      <eye:buttons rendered="#{smsExportStat.showFilter}">
        <eye:button>
          <h:commandLink value="#{msg['smsc.export.button']}" action="#{smsExportStat.apply}"/>
        </eye:button>
        <eye:button>
          <h:commandLink value="#{msg['clear.button']}" action="#{smsExportStat.clear}"/>
        </eye:button>
        <eye:space/>
      </eye:buttons>


      <eye:updatableContent updatePeriod="1" enabled="#{smsExportStat.showProgress}" rendered="#{!smsExportStat.showFilter}">

        <eye:message level="error" rendered="#{smsExportStat.error != null}">
          <h:outputText value="#{smsExportStat.error}"/>
        </eye:message>

        <h:panelGroup style="height: 10px">
          <h:outputText value="&#160;"/>
        </h:panelGroup>

        <h:panelGroup>
          <eye:message rendered="#{!smsExportStat.showProgress and smsExportStat.error == null}">
            <h:outputText value="#{msg['smsc.sms.export.success']}"/>
          </eye:message>
          <smsc:pageSubtitle rendered="#{smsExportStat.showProgress}" value="#{msg['smsc.stat.export.export']} #{smsExportStat.percents}%"/>
        </h:panelGroup>

        <p/>

        <eye:buttons rendered="#{smsExportStat.showResults}">
          <eye:button>
            <h:commandLink value="#{msg['smsc.export.more.button']}" action="#{smsExportStat.more}"/>
          </eye:button>
          <eye:space/>
        </eye:buttons>


        <h:panelGrid columns="3" style="height: 20px; padding-top: 10px"  columnClasses="preprogress,progress,postprogress">
          <h:outputText value="&#160;"/>
          <eye:progressBar current="#{smsExportStat.current}" maximum="#{smsExportStat.total}" rendered="#{smsExportStat.showProgress}"/>
          <h:outputText value="&#160;"/>
        </h:panelGrid>

      </eye:updatableContent>


    </h:form>

    <script type="text/javascript">
      function changeType() {
        var e = document.getElementById('export:type:0');
        if(e == null) {
          return;
        }

        var storageType = document.getElementById('export:storageType');
        if(storageType.options[0].selected) {
          document.getElementById('export:date').style.display='none';
          document.getElementById('export:date_label').style.display='none';
        }else {
          document.getElementById('export:date').style.display='';
          document.getElementById('export:date_label').style.display='';
        }
        if(e.checked == 'checked' || e.checked == true) {
          var operStFl = (storageType != null &amp;&amp; storageType.options[0].selected);
          var operSt = operStFl ? '' : 'none';
          var archSt = !operStFl ? '' : 'none';
          document.getElementById('export:def_arch_source').style.display=archSt;
          document.getElementById('export:def_arch_user').style.display=archSt;
          document.getElementById('export:def_arch_pass').style.display=archSt;
          document.getElementById('export:def_arch_prefix').style.display=archSt;
          document.getElementById('export:def_oper_source').style.display=operSt;
          document.getElementById('export:def_oper_user').style.display=operSt;
          document.getElementById('export:def_oper_pass').style.display=operSt;
          document.getElementById('export:def_oper_prefix').style.display=operSt;
          document.getElementById('cus_source').style.display='none';
          document.getElementById('cus_user').style.display='none';
          document.getElementById('cus_pass').style.display='none';
          document.getElementById('cus_prefix').style.display='none';
        }else {
          document.getElementById('export:def_oper_source').style.display='none';
          document.getElementById('export:def_oper_user').style.display='none';
          document.getElementById('export:def_oper_pass').style.display='none';
          document.getElementById('export:def_oper_prefix').style.display='none';
          document.getElementById('export:def_arch_source').style.display='none';
          document.getElementById('export:def_arch_user').style.display='none';
          document.getElementById('export:def_arch_pass').style.display='none';
          document.getElementById('export:def_arch_prefix').style.display='none';
          document.getElementById('cus_source').style.display='';
          document.getElementById('cus_user').style.display='';
          document.getElementById('cus_pass').style.display='';
          document.getElementById('cus_prefix').style.display='';
        }
      }
      changeType();
    </script>

  </ui:define>

</ui:composition>


</html>
