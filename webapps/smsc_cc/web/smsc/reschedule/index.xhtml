<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:tr="http://myfaces.apache.org/trinidad"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:eye="http://taglib.eyeline.mobi">

<ui:composition template="/templates/main.xhtml">

  <ui:define name="sme_title">
    <eye:pageTitle title="#{msg['smsc.reschedule']}"/>
  </ui:define>

  <ui:define name="content">

    <tr:form id="reschedule_list">

      <tr:inputHidden value="#{reschedule.index_initialized}" id="index_initialized"/>

      <t:saveState value="#{reschedule.defaultReschedule}"/>
      <t:saveState value="#{reschedule.reschedules}"/>


      <eye:buttons>
        <eye:button>
          <tr:commandLink text="#{msg['add.button']}" id="add1" action="RESCHEDULE_EDIT"
                          actionListener="#{reschedule.edit}"/>
        </eye:button>
        <eye:button>
          <tr:commandLink text="#{msg['delete.button']}" id="delete1" actionListener="#{reschedule.removeSelected}"
                          onclick="if (!confirm('#{msg['smsc.delete.records']}')) return false">
            <f:param name="delete" value=""/>
          </tr:commandLink>
        </eye:button>
        <eye:space/>
        <eye:button>
          <h:commandLink value="#{msg['submit.button']}" id="submit1" action="#{reschedule.submit}"/>
        </eye:button>
        <eye:button>
          <tr:commandLink text="#{msg['reset.button']}" action="RESCHEDULE" actionListener="#{reschedule.reset}"/>
        </eye:button>
      </eye:buttons>

      <tr:panelFormLayout inlineStyle="padding:20px">
        <tr:panelLabelAndMessage label="#{msg['smsc.reschedule.default']}">
          <tr:inputText value="#{reschedule.defaultReschedule.intervals}" required="true" simple="true">
            <tr:validateRegExp pattern="#{reschedule.reschedulePattern}"
                               messageDetailNoMatch="#{msg['smsc.reschedule.edit.invalid.intervals']}"/>
          </tr:inputText>
        </tr:panelLabelAndMessage>
      </tr:panelFormLayout>

      <t:div id="asdf">

        <eye:dataTable value="#{reschedule.rescheduleModel}" selectedRows="#{reschedule.selectedRows}" var="r">

          <eye:row rowId="#{r.intervals}" innerData="#{!empty r.statuses}" opened="true">

            <eye:column name="reschedules" title="" width="50%">
              <h:commandLink value="#{r.intervals}" action="#{reschedule.edit}">
                <f:param name="reschedule" value="#{r.intervals}"/>
              </h:commandLink>
            </eye:column>

            <f:facet name="innerData">
              <h:panelGroup >          
                <h:dataTable value="#{r.statuses}" var="status" columnClasses="column50Width, columnTopLeftAlign">
                  <h:column>
                    <tr:outputText/>
                  </h:column>
                  <h:column>
                    <tr:outputText value="#{status}" converter="smpp_status_converter"/>
                  </h:column>
                </h:dataTable>
              </h:panelGroup>
            </f:facet>

          </eye:row>

        </eye:dataTable>

      </t:div>


      <eye:buttons>
        <eye:button>
          <tr:commandLink text="#{msg['add.button']}" id="add2" action="RESCHEDULE_EDIT"
                          actionListener="#{reschedule.edit}"/>
        </eye:button>
        <eye:button>
          <tr:commandLink text="#{msg['delete.button']}" id="delete2" actionListener="#{reschedule.removeSelected}"
                          onclick="if (!confirm('#{msg['smsc.delete.records']}')) return false">
            <f:param name="delete" value=""/>
          </tr:commandLink>
        </eye:button>
        <eye:space/>
        <eye:button>
          <h:commandLink value="#{msg['submit.button']}" id="submit2" action="#{reschedule.submit}"/>
        </eye:button>
        <eye:button>
          <tr:commandLink text="#{msg['reset.button']}" action="RESCHEDULE" actionListener="#{reschedule.reset}"/>
        </eye:button>
      </eye:buttons>



    </tr:form>

  </ui:define>

</ui:composition>


</html>
