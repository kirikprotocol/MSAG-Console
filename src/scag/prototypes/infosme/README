   Описание прототипа "честной" рассылки сообщений в InfoSme.
   ---------------------------------------------------------

Сущности, представленные в прототипе:

Processor -- выполняет основной цикл рассылки и вызывает
        методы остальных обьектов.  Также в его обязанности входит
        управление рассылками: активация, деактивация, уничтожение;

Sender -- содержит список всех коннекторов и определяет
        порядок их выборки для отсылки сообщений;

Connector -- соответствует региону в реальном InfoSme.
        Имеет ограничение по скорости рассылки (bandwidth).  В программе
        м/б несколько обьектов такого класса, по одному на регион;

TaskDispatcher -- определяет порядок выборки активных рассылок по каждому региону
        для отсылки сообщений в него;

Task -- рассылка (задача).  Содержит сгенерированные сообщения,
        упорядоченные по времени отсылки.
        Также имеет атрибуты: приоритет и скорость рассылки.
        В программе м/б несколько обьектов такого класса.

ScoredList -- шаблонный вспомогательный класс, определяет действия
        с сортированным списком обьектов, с приоритетом посылки/приема сообщений.
        Для упорядочивания используется атрибут score, который изменяется после
        выполнения действия с соответствующим обьектом.

SpeedControl -- вспомогательный класс для определения времени готовности
        посылки/приема сообщения.


           Основной цикл.
           -------------

Processor содержит содержит список неактивных рассылок, а также ссылки на
экземпляры TaskDispatcher'а и Sender'а.

Processor выполняет основной цикл приложения:
1. Ожидание прихода времени nextTime, вычисленного в предыдущем проходе цикла;
2. Выполнение ожидающих операций с рассылками: активация, деактивация, уничтожение;
3. Получение текущего времени curTime и вызов метода send(curTime) у обьекта Sender.
   Метод возвращает значение nextTime для следующей итерации цикла.
   Переход на начало цикла.


Sender содержит список всех Connector'ов, упорядоченных по score.  В методе
send по очереди проверяются все Connector'ы conn начиная с обьекта с минимальным score:
1. Проверяется, готов ли очередной Connector к приему сообщения, если нет,
   то вычисляется время готовности nextTime этого коннектора;
2. Если коннектор conn готов, то вызывается метод processConnector(curTime,conn)
   у обьекта TaskDispatcher.  Величина score для данного коннектора увеличивается
   на значение 1000/conn.bandwidth;
3. Список коннекторов пересортировывается;
4. Если ни один коннектор не был готов, возвращается минимальное время nextTime
   готовности одного из коннекторов, иначе возвращается 0.


TaskDispatcher содержит несколько списков (активных) рассылок, по одному списку на
зарегистрированный коннектор.  Все рассылки в списке упорядочены по score.
Но при этом одна и та же рассылка входит во все списки, но с разным score.
Возможны следующие модификации списков:
1. Добавление новой активной рассылки.  Рассылка добавляется в конец каждого из 
списков (с присвоением соответствующего score);
2. Удаление всех неактивных рассылок.  Неактивные рассылки убираются из каждого
   из списков.  Рассылка считается неактивной, если она отключена или в ней не осталось
   новых сообщений;
3. Добавление нового коннектора.  При этом создается новый список активных рассылок
   для нового коннектора, с присвоением score=0 для каждой рассылки в этом списке.

В методе processConnector(curTime,conn), вызываемом из Sender'а,
выполняется следующее:

1. Проверяется, готова ли очередная рассылка для посылки сообщения в данный
   коннектор conn.  Рассылка может быть не готова если все сообщения в будущем,
   либо если в рассылке вообще нет сообщений для данного коннектора, либо если
   сработало ограничение по скорости рассылки.  В случае неготовности рассылка
   возвращает время nextTime своей готовности;
2. Если рассылка task готова, то из нее выбирается очередное сообщение msg для данного
   коннектора, и вызывается conn.sendMessage(msg).  Производится инкремент
   score данной рассылки на величину 1000/task.priority().
3. Список рассылок пересортировывается;
4. Если ни одна рассылка не была готова, то данный коннектор conn задерживается до
   готовности ближайшей рассылки nextTime.


Для управления готовностью обьектов Connector, Task к посылке/приему 
сообщений используется вспомогательный класс SpeedControl.
Обьект данного класса имеет атрибут скорость/пропускная способность,
и три основных метода: isReady(curTime), suspend(nextTime), consumeQuant().
1. isReady(curTime) проверяет, разрешено ли посылать/принимать сообщения.
   Для оптимизации текущее время curTime необходимо передавать в виде аргумента;
2. suspend(nextTime) используется для задержки посылки/приема до времени nextTime;
3. consumeQuant() вызывается после посылки сообщения, для уведомления, что
   сообщения послано и вычисления следующего времени готовности.
