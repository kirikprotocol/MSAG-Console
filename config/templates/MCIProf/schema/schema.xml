<?xml version="1.0" encoding="windows-1251"?>
<!DOCTYPE scenarios SYSTEM "file:///scenarios.dtd">
<scenarios>
  <scenario id="0" active="1" sms="1" ussd="2" resources="resources.xml">

    <page id="MAIN_PAGE" question="0">
      <pageExecutor class="ru.sibinco.mci.EntryExecutor">
        <initParam name="pagePrefixedStrategy" value="prefixed_entry"/>
        <initParam name="pageRedirectStrategy" value="redirect_entry"/>
      </pageExecutor>
    </page>
    
    <page id="redirect_entry" question="0">
      <!-- Show MAIN dialog & set MAIN attribute -->
      <pageExecutor class="ru.sibinco.mci.MainExecutor">
        <bundle name="system"/>
      </pageExecutor>
      <command name="1" target="divert_mgr"/>
      <command name="2" target="profile_mgr"/>
      <command name="3" target="smshelp_mgr"/>
      <command name="(**)" target="EXIT_PAGE"/>
    </page>
    <page id="prefixed_entry" question="0">
      <!-- Show MAIN dialog & set MAIN attribute -->
      <pageExecutor class="ru.sibinco.mci.MainExecutor">
        <bundle name="system"/>
      </pageExecutor>
      <command name="1" target="profile_mgr_alt"/>
      <command name="2" target="profile_mgr"/>
      <command name="3" target="smshelp_mgr"/>
      <command name="(**)" target="EXIT_PAGE"/>
    </page>

    <page id="EXIT_PAGE" question="0">
      <pageExecutor class="ru.sibinco.mci.ExitExecutor">
        <bundle name="system"/>
      </pageExecutor>
    </page>

    <page id="divert_mgr" question="0">
      <!-- if (!MAIN attr && !"0") set divert & remove MAIN attribute -->
      <pagePreProcessor class="ru.sibinco.mci.divert.DivertManagerPreprocessor">
        <bundle name="system"/>
        <bundle name="divert"/>
      </pagePreProcessor>
      <!-- Query & show divert info in resons dialog -->
      <pageExecutor class="ru.sibinco.mci.divert.DivertManagerExecutor">
        <bundle name="system"/>
        <bundle name="divert"/>
      </pageExecutor>
      <command name="1" target="divert_set"/>   <!-- занят       -->
      <command name="2" target="divert_set"/>   <!-- отсутств.   -->
      <command name="3" target="divert_set"/>   <!-- не доступен -->
      <command name="4" target="divert_set"/>   <!-- безусл.     -->
      <command name="(**)" target="redirect_entry"/>
    </page>
    <page id="divert_set" question="0">
      <!-- Set divert reason attribute (занят/отсутств./не доступен/безусл.) -->
      <pagePreProcessor class="ru.sibinco.mci.divert.DivertSetPreprocessor">
        <bundle name="system"/>
        <bundle name="divert"/>
      </pagePreProcessor>
      <!-- Show alternatives for select divert value -->
      <pageExecutor class="ru.sibinco.mci.divert.DivertSetExecutor">
        <bundle name="system"/>
        <bundle name="divert"/>
      </pageExecutor>
      <command name="(**)" target="divert_mgr"/>
    </page>

    <page id="profile_mgr_alt" question="0">
      <!-- if (!MAIN attr && !"0") change profile event mask & remove MAIN attribute -->
      <pagePreProcessor class="ru.sibinco.mci.profile.ProfileManagerAltPreprocessor">
        <bundle name="system"/>
        <bundle name="profile"/>
      </pagePreProcessor>
      <!-- Query & show profile event maks info for resons -->
      <pageExecutor class="ru.sibinco.mci.profile.ProfileManagerAltExecutor">
        <bundle name="system"/>
        <bundle name="profile"/>
      </pageExecutor>
      <command name="1" target="profile_mgr_alt"/>
      <command name="2" target="profile_mgr_alt"/>
      <command name="3" target="profile_mgr_alt"/>
      <command name="4" target="profile_mgr_alt"/>
      <command name="(**)" target="prefixed_entry"/>
    </page>

    <page id="profile_mgr" question="0">
      <!-- if (!MAIN attr && !"0") change profile & remove MAIN attribute -->
      <pagePreProcessor class="ru.sibinco.mci.profile.ProfileManagerPreprocessor">
        <bundle name="system"/>
        <bundle name="profile"/>
      </pagePreProcessor>
      <!-- Query & show profile info in change dialog -->
      <pageExecutor class="ru.sibinco.mci.profile.ProfileManagerExecutor">
        <bundle name="system"/>
        <bundle name="profile"/>
      </pageExecutor>
      <command name="1" target="profile_mgr"/>   <!-- sms абоненту (да/нет)  -->
      <command name="2" target="profile_set"/>   <!-- тип сообщения (...)    -->
      <command name="3" target="profile_mgr"/>   <!-- sms звонившим (да/нет) -->
      <command name="4" target="profile_set"/>   <!-- тип нотификации (...)  -->
      <command name="(**)" target="MAIN_PAGE"/>
    </page>
    <page id="profile_set" question="0">
      <!-- Set inform or notify reason attribute -->
      <pagePreProcessor class="ru.sibinco.mci.profile.ProfileSetPreprocessor">
        <bundle name="system"/>
        <bundle name="profile"/>
      </pagePreProcessor>
      <!-- Show message format alternatives for inform/notify type -->
      <pageExecutor class="ru.sibinco.mci.profile.ProfileSetExecutor">
        <bundle name="system"/>
        <bundle name="profile"/>
      </pageExecutor>
      <command name="(**)" target="profile_mgr"/>
    </page>

    <page id="smshelp_mgr" question="0">
      <pageExecutor class="ru.sibinco.mci.HelpExecutor">
        <bundle name="help"/>
      </pageExecutor>
      <command name="(**)" target="MAIN_PAGE"/>
    </page>

  </scenario>
</scenarios>
